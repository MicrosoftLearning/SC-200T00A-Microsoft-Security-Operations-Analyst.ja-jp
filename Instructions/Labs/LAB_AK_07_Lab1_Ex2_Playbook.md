---
lab:
  title: 演習 2 - プレイブックを作成する
  module: Learning Path 7 - Create detections and perform investigations using Microsoft Sentinel
---

# <a name="learning-path-7---lab-1---exercise-2---create-a-playbook"></a>ラーニング パス 7 - ラボ 1 - 演習 2 - プレイブックを作成する

## <a name="lab-scenario"></a>ラボのシナリオ

![ラボの概要。](../Media/SC-200-Lab_Diagrams_Mod7_L1_Ex2.png)

あなたは、Microsoft Sentinel を実装した会社で働いているセキュリティ運用アナリストです。 Microsoft Sentinel を使って脅威を検出および軽減する方法を学習する必要があります。 ここで、Microsoft Sentinel からルーチンとして実行できるアクションに応答して修復する必要があります。

プレイブックを使用すると、脅威への対応を自動化および調整したり、内部と外部両方の他のシステムと統合したり、分析ルールまたは自動化ルールによってそれぞれトリガーされた場合に、特定のアラートやインシデントに応答して自動的に実行されるように設定できます。 


### <a name="task-1-create-a-security-operations-center-team-in-microsoft-teams"></a>タスク 1:Microsoft Teams でセキュリティ オペレーション センター チームを作成する

このタスクでは、このラボ用のMicrosoft Teamsを作成します。

1. 管理者として WIN1 仮想マシンにログインします。パスワードは**Pa55w.rd**。  

1. Edge ブラウザーで、新しいタブを開き、Microsoft Teams ポータル (https://teams.microsoft.com) ) に移動します。

1. **[サインイン]** ダイアログ ボックスで、ラボ ホスティング プロバイダーから提供された**テナントの電子メール** アカウントをコピーして貼り付け、 **[次へ]** を選択します。

1. **[パスワードの入力]** ダイアログ ボックスで、ラボ ホスティング プロバイダーから提供された**テナントのパスワード**をコピーして貼り付け、 **[サインイン]** を選択します。

1. 表示される可能性のある Teams ポップアップをすべて閉じます。

1. まだ選択されていない場合は、左側のメニューの **[Teams]** を選択し、下部にある **[チームに参加、またはチームを作成します]** を選択します。

1. メイン ウィンドウで **[チームの作成]** ボタンを選択します。

1. **[最初から]** ボタンを選択します。

1. **[プライベート]** ボタンを選択します。

1. チームに名前を付けます: 「**SOC**」と入力し、**[作成]** ボタンを選択します。

1. SOC にメンバーを追加 画面で、**スキップ** ボタンを選択します。 

1. [Teams] ブレードを下にスクロールし、新しく作成された SOC チームを見つけ、名前の右側にある省略記号 **[...]** を選択し、 **[チャネルの追加]** を選択します。

1. "新しいアラート" のチャネル名を入力し、**[追加]** ボタンを選択します。**


### <a name="task-2-create-a-playbook-in-microsoft-sentinel"></a>タスク 2:Microsoft Sentinel プレイブックを作成する

このタスクでは、Microsoft Sentinel でプレイブックとして使用されるロジック アプリを作成します。

1. Edge ブラウザーで、Azure portal (https://portal.azure.com ) に移動します。

1. **[サインイン]** ダイアログ ボックスで、ラボ ホスティング プロバイダーから提供された**テナントの電子メール** アカウントをコピーして貼り付け、 **[次へ]** を選択します。

1. **[パスワードの入力]** ダイアログ ボックスで、ラボ ホスティング プロバイダーから提供された**テナントのパスワード**をコピーして貼り付け、 **[サインイン]** を選択します。

1. Azure portal の検索バーに「*Sentinel*」と入力し、**[Microsoft Sentinel]** を選択します。

1. 先ほど作成した Microsoft Sentinel ワークスペースを選択します。

1. ページの左側にある *[コンテンツ管理]* 領域の下にある **[コミュニティ]** ページを選択します。

1. 右側のペインで、 **[コミュニティのコンテンツをオンボードする]** リンクを選択します。 これにより、Microsoft Sentinel GitHub コンテンツ用の Edge ブラウザーの新しいタブが開きます。

1. **Solutions** フォルダーを選択します。

1. 次に、''**SentinelSOARessentials**'' フォルダー、''**Playbooks**'' フォルダーの順に選択します。

1. "**Post-Message-Teams**" フォルダーを選択します。

1. readme.md ボックスで、2 番目の *[クイック デプロイ]* オプションの **[Deploy with alert trigger]/(アラート トリガーを使用してデプロイする)** まで下にスクロールし、 **[Azure に配置する]** ボタンを選択します。  

    >**非常に重要**: 使用する 2 つの異なる Microsoft Sentinel トリガーであるインシデントとアラートであることに注意してください。 アラート (2 つ目) を選択してください。

1. [Azure サブスクリプション] が選択されていることを確認します。

1. リソース グループで **[新規作成]** を選択し、「*RG-Playbooks*」と入力して **[OK]** を選択します。

1. *[リージョン]* の既定値は **[(米国) 米国東部]** のままにします。

1. *プレイブック名* が "PostMessageTeams-OnAlert" であることを確認し、 **[確認と作成]** を選択します。 **ヒント:** 名前が異なる場合は、GitHub に戻り、 **[アラート トリガーを使用してデプロイ]** プレイブックを選択します。

1. ここで **[作成]** を選択します。 

    >**注:**  次のタスクに進む前に、デプロイが完了するまで待機します。


### <a name="task-3-update-a-playbook-in-microsoft-sentinel"></a>タスク 3:Microsoft Sentinel プレイブックを更新する

このタスクでは、作成した新しいプレイブックを適切な接続情報で更新します。

1. Azure portal の検索バーに「*Sentinel*」と入力してから、**[Microsoft Sentinel]** を選択します。

1. Microsoft Sentinel ワークスペースを選択します。

1. *[構成]* 領域から **[自動化]** を選択し、 **[アクティブなプレイブック]** タブを選択します。

1. **PostMessageTeams-OnAlert** プレイブックを選択します。 **ヒント:** プレイブックが表示されない場合は、Ctrl + F5 キーを押して Azure portal ページを更新します。

1. *PostMessageTeams-OnAlert* の Logic App ページで、コマンド メニューの **[編集]** を選択します。

1. *"最初"* のブロックの **[Microsoft Sentinel アラート]** を選択します。

1. **[接続の変更]** リンクを選択します。

1. **[新規追加]** を選択し、 **[サインイン]** を選択します。 新しいウィンドウで、メッセージが表示されたら、Azure サブスクリプション管理者の資格情報を選択します。 ブロックの最後の行に "Connected to your-admin-username" (管理者ユーザー名に接続済み) と表示されます。

1. 次に、*2 番目の* ブロック、 **[アラート - インシデントの取得]** を選択します。

1. **[接続の変更]** リンクを選択します。

1. *[表示名]* で、Azure 管理者ユーザー名を持つ接続を選択します。 **ヒント:** admin@ZZZZZZ.onmicrosoft.com. ブロックの最後の行に "Connected to your-admin-username" (管理者ユーザー名に接続済み) と表示されます。

1. 次に、*3 番目の* ブロック、 **[接続]** を選択します。

1. **[新規追加]** を選択し、メッセージが表示されたら Azure 管理者の資格情報を選択します。 ブロックの最後の行に "Connected to your-admin-username" (管理者ユーザー名に接続済み) と表示されます。

1. ブロックの名前が **[メッセージを投稿する (V3)]** に変更されました。 *[Teams]* フィールドの最後にある **[X]** を選択して内容をクリアします。 フィールドは、Microsoft Teams から利用可能な Teams のリストを含むドロップダウンに変更されます。 **[SOC]** を選択します。

1. *[チャネル]* フィールドでも同じ操作を行い、フィールドの末尾にある **[X]** を選択して内容をクリアします。 フィールドがドロップダウンに変更され、SOC チームのチャネルの一覧が表示されます。 **[新しいアラート]** を選択します。

1. コマンド バーの **[保存]** を選択します。

これらはのちのラボで使用します。

## <a name="proceed-to-exercise-3"></a>演習 3 に進む
